This code was written by Jonathan Protzenko
